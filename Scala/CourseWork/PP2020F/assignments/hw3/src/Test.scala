package pp202002.hw3test

import pp202002.hw3._

object Test extends App
{
    val caesarE = Caesar.buildEncryptor(23)
    println(caesarE.encrypt("THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")._1 == "QEBNRFZHYOLTKCLUGRJMPLSBOQEBIXWVALD")

    val caesarD = Caesar.buildDecryptor(23)
    println(caesarD.decrypt("QEBNRFZHYOLTKCLUGRJMPLSBOQEBIXWVALD")._1 == "THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")


    val qwertyWheel = Wire("QWERTYUIOPASDFGHJKLZXCVBNM")
    val revReflector = Wire("ZYXWVUTSRQPONMLKJIHGFEDCBA")
    val testSetting = EnigmaSettings(qwertyWheel :: Nil, revReflector)
    val testEnigmaEnc = Enigma.buildEncryptor(testSetting)
    val testEnigmaDec = Enigma.buildDecryptor(testSetting)
    println(testEnigmaEnc.encrypt("THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")._1 == "BGRNPHYUUKFEDHKUMWFLWHKFJKXOQEVFRYI")
    println(testEnigmaDec.decrypt("BGRNPHYUUKFEDHKUMWFLWHKFJKXOQEVFRYI")._1 == "THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")

    //println(testEnigmaEnc.encrypt("THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")._1)
    //println(testEnigmaEnc.decrypt("BGRNPHYUUKFEDHKUMWFLWHKFJKXOQEVFRYI")._1)

    // This is the real enigma machine settings used in WWII.
    val UKW_B_Reflector = Wire("YRUHQSLDPXNGOKMIEBFZCWVJAT")
    val wheel1 = Wire("EKMFLGDQVZNTOWYHXUSPAIBRCJ")
    val wheel2 = Wire("AJDKSIRUXBLHWTMCQGZNPYFVOE")
    val wheel3 = Wire("BDFHJLCPRTXVZNYEIWGAKMUSQO")

    val wheel4 = Wire("ESOVPZJAYQUIRHXLNFTGKDCMWB")
    val wheel5 = Wire("VZBRGITYUPSDNHLXAWMJQOFECK")

    val enigmaM3Settings = EnigmaSettings(wheel3 :: wheel2 :: wheel1 :: Nil, UKW_B_Reflector)
    val enigmaM3 = Enigma.buildEncryptor(enigmaM3Settings)

    val enigmaM3_5Settings = EnigmaSettings(wheel5 :: wheel4 :: wheel3 :: wheel2 :: wheel1 :: Nil, UKW_B_Reflector)
    val enigmaM3_5 = Enigma.buildEncryptor(enigmaM3_5Settings)

    val k_Reflector = Wire("IMETCGFRAYSQBZXWLHKDVUPOJN")
    val kwheel1 = Wire("PEZUOHXSCVFMTBGLRINQJWAYDK")
    val kwheel2 = Wire("ZOUESYDKFWPCIQXHMVBLGNJRAT")
    val kwheel3 = Wire("EHRVXGAOBQUSIMZFLYNWKTPDJC")
    val kenigmaSettings = EnigmaSettings(kwheel3 :: kwheel2 :: kwheel1 :: Nil, k_Reflector)
    val kenigma = Enigma.buildEncryptor(kenigmaSettings)


    val my_Reflector = Wire("QYHOGNECVPUZTFDJAXWMKISRBL")
    val mywheel1 = Wire("JGDQOXUSCAMIFRVTPNEWKBLZYH")
    val mywheel2 = Wire("NTZPSFBOKMWRCJDIVLAEYUXHGQ")
    val mywheel3 = Wire("JVIUBHTCDYAKEQZPOSGXNRMWFL")
    val myenigmaSettings = EnigmaSettings(mywheel3 :: mywheel2 :: mywheel1 :: Nil, my_Reflector)
    val myenigma = Enigma.buildEncryptor(myenigmaSettings)

    // You can check your implementation from the site below.
    // https://www.101computing.net/enigma-machine-emulator/
    // As we do not implement Turnover notch position,
    // the result of our enigma machine should be differed from 21th letter.
    println(enigmaM3.encrypt("THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")._1 == "OPCILLAZFXLQTDNLGGLEKWWTHKQKGXIEZKD")
    println(enigmaM3.decrypt("OPCILLAZFXLQTDNLGGLEKWWTHKQKGXIEZKD")._1 == "THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG")

    def test(s: String, eni: Enigma) = {
        val e = eni.encrypt(s)._1
        val d = eni.decrypt(eni.encrypt(s)._1)._1
        println(e)
        println(d)
        println(s == d)
    }

    val test1 = "YESTERDAYALLMYTROUBLESSEEMEDSOFARAWAYNOWITLOOKSASTHOUGHTHEYREHERETOSTAYOHIBELIEVEINYESTERDAYSUDDENLYIMNOTHALFTHEMANIUSEDTOBETHERESASHADOWHANGINOVERMEOHYESTERDAYCAMESUDDENLYWHYSHEHADTOGOIDONTKNOWSHEWOULDNTSAYISAIDSOMETHINGWRONGNOWILONGFORYESTERDAYYESTERDAYLOVEWASSUCHANEASYGAMETOPLAYNOWINEEDAPLACETOHIDEAWAYOHIBELIEVEINYESTERDAYWHYSHEHADTOGOIDONTKNOWSHEWOULDNTSAYISAIDSOMETHINGWRONGNOWILONGFORYESTERDAYYESTERDAYLOVEWASSUCHANEASYGAMETOPLAYNOWINEEDAPLACETOHIDEAWAYOHIBELIEVEINYESTERDAYMMMMMMMMMMMMMM"
    val test2 = "HELLODARKNESSMYOLDFRIENDIVECOMETOTALKWITHYOUAGAINBECAUSEAVISIONSOFTLYCREEPINGLEFTITSSEEDSWHILEIWASSLEEPINGANDTHEVISIONTHATWASPLANTEDINMYBRAINSTILLREMAINSWITHINTHESOUNDOFSILENCEINRESTLESSDREAMSIWALKEDALONENARROWSTREETSOFCOBBLESTONENEATHTHEHALOOFASTREETLAMPITURNEDMYCOLLARTOTHECOLDANDDAMPWHENMYEYESWERESTABBEDBYTHEFLASHOFANEONLIGHTTHATSPLITTHENIGHTANDTOUCHEDTHESOUNDOFSILENCEANDINTHENAKEDLIGHTISAWTENTHOUSANDPEOPLEMAYBEMOREPEOPLETALKINGWITHOUTSPEAKINGPEOPLEHEARINGWITHOUTLISTENINGPEOPLEWRITINGSONGSTHATVOICESNEVERSHAREANDNOONEDAREDDISTURBTHESOUNDOFSILENCEFOOLSSAIDIYOUDONOTKNOWSILENCELIKEACANCERGROWSHEARMYWORDSTHATIMIGHTTEACHYOUTAKEMYARMSTHATIMIGHTREACHYOUBUTMYWORDSLIKESILENTRAINDROPSFELLANDECHOEDINTHEWELLSOFSILENCEWITHINTHESOUNDOFSILENCE"
    val test3 = "THISROMEOISBLEEDINGBUTYOUCANTSEEHISBLOODITSNOTHINGBUTSOMEFEELINGSTHATTHISOLDDOGKICKEDUPITSBEENRAININGSINCEYOULEFTMENOWIMDROWNINGINTHEFLOODYOUSEEIVEALWAYSBEENAFIGHTERBUTWITHOUTYOUIGIVEUPICANTSINGALOVESONGLIKETHEWAYITSMEANTTOBEWELLIGUESSIMNOTTHATGOODANYMOREBUTBABYTHATSJUSTMEANDIWILLLOVEYOUBABYALWAYSANDILLBETHEREFOREVERANDADAYALWAYSILLBETHERETILTHESTARSDONTSHINETILTHEHEAVENSBURSTANDTHEWORDSDONTRHYMEANDIKNOWWHENIDIEYOULLBEONMYMINDANDILLLOVEYOUALWAYSNOWYOURPICTURESTHATYOULEFTBEHINDAREJUSTMEMORIESOFADIFFERENTLIFESOMETHATMADEUSLAUGHSOMETHATMADEUSCRYONETHATMADEYOUHAVETOSAYGOODBYEWHATIDGIVETORUNMYFINGERSTHROUGHYOURHAIRTOTOUCHYOURLIPSTOHOLDYOUNEARWHENYOUSAYYOURPRAYERSTRYTOUNDERSTANDIVEMADEMISTAKESIMJUSTAMANWHENHEHOLDSYOUCLOSEWHENHEPULLSYOUNEARWHENHESAYSTHEWORDSYOUVEBEENNEEDINGTOHEARIWISHIWASHIMWITHTHESEWORDSOFMINETOSAYTOYOUTILTHEENDOFTIMETHATIWILLLOVEYOUBABYALWAYSANDILLBETHEREFOREVERANDADAYALWAYSIFYOUTOLDMETOCRYFORYOUICOULDIFYOUTOLDMETODIEFORYOUIWOULDTAKEALOOKATMYFACETHERESNOPRICEIWONTPAYTOSAYTHESEWORDSTOYOUWELLTHEREAINTNOLUCKINTHESELOADEDDICEBUTBABYIFYOUGIVEMEJUSTONEMORETRYWECANPACKUPOUROLDDREAMSANDOUROLDLIVESWELLFINDAPLACEWHERETHESUNSTILLSHINESANDIWILLLOVEYOUBABYALWAYSANDILLBETHEREFOREVERANDADAYALWAYSILLBETHERETILTHESTARSDONTSHINETILTHEHEAVENSBURSTANDTHEWORDSDONTRHYMEIKNOWWHENIDIEYOULLBEONMYMINDANDILLLOVEYOUALWAYSALWAYSALWAYS"
    val test4 = "LOREMIPSUMDOLORSITAMETCONSECTETURADIPISCINGELITSEDDOEIUSMODTEMPORINCIDIDUNTUTLABOREETDOLOREMAGNAALIQUAVULPUTATEENIMNULLAALIQUETPORTTITORLACUSINHACHABITASSEPLATEADICTUMSTQUISQUEORNARESUSPENDISSESEDNISILACUSSEDVIVERRATELLUSIDINTERDUMVELITLAOREETIDDONECVELITEGESTASDUIIDORNAREARCUODIOUTLECTUSSITAMETESTPLACERATINEGESTASGRAVIDARUTRUMQUISQUENONTELLUSORCIETMALESUADAFAMESACTURPISLEOADIAMSOLLICITUDINTEMPORENIMUTSEMVIVERRAALIQUETEGETSITAMETFEUGIATVIVAMUSATAUGUEEGETARCUDICTUMELEIFENDMIINNULLAPOSUEREVELITSEDULLAMCORPERMORBITINCIDUNTORNAREMASSADONECMASSASAPIENFAUCIBUSETMOLESTIEACVELITEGESTASDUIIDORNAREARCUODIOUTERATVELITSCELERISQUEINDICTUMNONCONSECTETURLUCTUSVENENATISLECTUSMAGNAFRINGILLAEGESTASCONGUEQUISQUEEGESTASDIAMINARCUDIAMINARCUCURSUSEUISMODQUISVIVERRASEDNISILACUSSEDVIVERRATELLUSINHACSITAMETJUSTODONECENIMDIAMVULPUTATEUTPHARETRAULLAMCORPERVELITSEDULLAMCORPERMORBITINCIDUNTORNAREPORTTITORMASSAIDNEQUEALIQUAMVESTIBULUMMORBIAUCTORNEQUEVITAETEMPUSQUAMPELLENTESQUENECNAMALIQUAMORCIACAUCTORAUGUEMAURISAUGUEPROINLIBERONUNCCONSEQUATINTERDUMVARIUSSITENIMSEDFAUCIBUSTURPISINEUDUISULTRICIESLACUSSEDTURPISTINCIDUNTEGESTASMAECENASPHARETRACONVALLISPOSUEREMORBILEOURNAMIIPSUMFAUCIBUSVITAEALIQUETNECULLAMCORPERSITSITAMETJUSTODONECENIMDIAMVULPUTATEUTVITAEALIQUETNECULLAMCORPERSITAMETTRISTIQUEETEGESTASQUISIPSUMSUSPENDISSEULTRICESGRAVIDADICTUMHABITANTMORBITRISTIQUESENECTUSETPURUSUTFAUCIBUSPULVINARELEMENTUMCONDIMENTUMMATTISPELLENTESQUEIDNIBHTORTORIDALIQUETLECTUSDONECETODIOPELLENTESQUEDIAMVOLUTPATELEMENTUMCURABITURVITAENUNCSEDVELITDIGNISSIMSODALESUTALIQUAMMALESUADABIBENDUMARCUVITAEELEMENTUMCURABITURVITAENUNCSEDSITAMETALIQUAMIDDIAMMAECENASULTRICIESMIVITAESAPIENPELLENTESQUEHABITANTMORBITRISTIQUESENECTUSETNETUSETPROINFERMENTUMLEOVELORCIPORTANONPULVINARPULVINARSAPIENETLIGULAULLAMCORPERMALESUADAPROINNECSAGITTISALIQUAMMALESUADABIBENDUMARCULECTUSNULLAATVOLUTPATDIAMUTVENENATISTELLUSTEMPUSQUAMPELLENTESQUENECNAMETLEODUISUTDIAMQUAMNULLAPORTTITORMASSASITAMETNISLPURUSINMOLLISNUNCSEDIDTURPISEGESTASSEDTEMPUSURNAETNISISCELERISQUEEUULTRICESVITAEAUCTORIPSUMDOLORSITAMETCONSECTETURADIPISCINGELITUTFACILISISMAGNAETIAMTEMPORORCIEULOBORTISENIMUTSEMVIVERRAALIQUETEGETSITAMETTELLUSDOLORSITAMETCONSECTETURADIPISCINGELITUTALIQUAMPURUSSITSCELERISQUEINDICTUMNONCONSECTETURAERATNAMORCIEULOBORTISELEMENTUMNIBHTELLUSMOLESTIENUNCNONBLANDITATTEMPORCOMMODOULLAMCORPERALACUSVESTIBULUMSEDARCUNONETLEODUISUTDIAMCONSEQUATSEMPERVIVERRANAMLIBEROJUSTOLAOREETSITAMETTINCIDUNTPRAESENTSEMPERFEUGIATNIBHANTEINNIBHMAURISCURSUSAUCTOREUAUGUEUTLECTUSARCUBIBENDUMATVARIUSIDSEMPERRISUSINHENDRERITGRAVIDARUTRUMQUISQUENONTURPISEGESTASSEDTEMPUSURNAETPHARETRAPURUSGRAVIDAQUISBLANDITTURPISCURSUSINHACHABITASSEQUAMVIVERRAORCISAGITTISEUMORBIBLANDITCURSUSRISUSATULTRICESMITEMPUSULTRICIESTRISTIQUENULLAALIQUETENIMTORTORMASSATINCIDUNTNUNCPULVINARSAPIENETLIGULAULLAMCORPERMALESUADAPROINSITAMETCONSECTETURADIPISCINGELITDIAMMAECENASSEDENIMUTSEMVIVERRAVULPUTATEEUSCELERISQUEFELISIMPERDIETPROINFERMENTUMLEOVELPROINSEDLIBEROENIMSEDFAUCIBUSTURPISSEDBLANDITLIBEROVOLUTPATSEDCRASORNAREARCUDUIESTULTRICIESINTEGERQUISAUCTORELITSEDVULPUTATEMIAMETCURSUSSITAMETDICTUM"
    val test5 = "SEDNISILACUSSEDVIVERRATELLUSINHACMAURISSITAMETMASSAVITAETORTORCONDIMENTUMLACINIAQUISVELINALIQUAMSEMFRINGILLAUTINNISLNISISCELERISQUEEUULTRICESVITAEAUCTOREULACUSVIVERRAVITAECONGUEEUCONSEQUATACFELISDONECULLAMCORPERMALESUADAPROINLIBERONUNCCONSEQUATINTERDUMVARIUSELEMENTUMPULVINARETIAMNONQUAMLACUSSUSPENDISSEFAUCIBUSINTERDUMTORTORVITAEPURUSFAUCIBUSORNARESUSPENDISSESEDNISIINNIBHMAURISCURSUSMATTISMOLESTIEAIACULISPULVINARPELLENTESQUEHABITANTMORBITRISTIQUESENECTUSTORTORCONDIMENTUMLACINIAQUISVELNUNCPULVINARSAPIENETLIGULAULLAMCORPERMALESUADAPROINLIBERONUNCMUSMAURISVITAEULTRICIESLEOINTEGERMALESUADANUNCVELRISUSACTORTORDIGNISSIMCONVALLISAENEANETTORTORATRISUSURNAETPHARETRAPHARETRAMASSAMASSAULTRICIESMICURSUSMATTISMOLESTIEAIACULISATERATTINCIDUNTORNAREMASSAEGETEGESTASPURUSVIVERRAACCUMSANINNISLINPELLENTESQUEMASSAPLACERATDUISULTRICIESLACUSFERMENTUMETSOLLICITUDINACORCIPHASELLUSEGESTASTELLUSRUTRUMTELLUSQUAMELEMENTUMPULVINARETIAMNONQUAMADIAMMAECENASSEDENIMUTSEMVIVERRAALIQUETEGETSITAMETESTPLACERATINEGESTASERATIMPERDIETENIMNULLAALIQUETPORTTITORLACUSLUCTUSDIAMDONECADIPISCINGTRISTIQUERISUSLACINIAQUISVELEROSDONECETMALESUADAFAMESACTURPISEGESTASINTEGEREGETALIQUETNIBHPURUSVIVERRAACCUMSANINNISLNISIPLACERATINEGESTASERATIMPERDIETSEDEUISMODVESTIBULUMMORBIBLANDITCURSUSRISUSATEGETFELISEGETNUNCLOBORTISMATTISALIQUAMFAUCIBUSELEMENTUMSAGITTISVITAEETLEODUISUTDIAMQUAMNULLAINORNAREQUAMVIVERRAORCISAGITTISEUVOLUTPATQUISAUCTORELITSEDVULPUTATEMISITAMETMAURISSEDRISUSULTRICIESTRISTIQUENULLAALIQUETACUTCONSEQUATSEMPERVIVERRANAMTURPISEGESTASPRETIUMAENEANPHARETRAMAGNAACPLACERATVESTIBULUMLECTUSEGETNUNCLOBORTISMATTISALIQUAMNULLAMVEHICULAIPSUMAARCUCURSUSVITAEEUNONDIAMPHASELLUSVESTIBULUMLOREMSEDRISUSSEDVULPUTATEODIOUTENIMBLANDITVOLUTPATMAECENASFUSCEUTPLACERATORCINULLAESTANTEINNIBHMAURISCURSUSMATTISMOLESTIEAAMETCURSUSSITAMETDICTUMSITINPELLENTESQUEMASSAPLACERATDUISULTRICIESGRAVIDAARCUACTORTORDIGNISSIMCONVALLISLACUSSEDTURPISTINCIDUNTIDALIQUETRISUSFEUGIATINANTEDUISATCONSECTETURLOREMDONECMASSASAPIENALIQUAMUTPORTTITORLEOAHABITASSEPLATEADICTUMSTVESTIBULUMRHONCUSESTAMETFACILISISMAGNAETIAMTEMPORORCIEULOBORTISELEMENTUMCRASORNAREARCUDUIVIVAMUSARCUFELISBIBENDUMUTDIAMQUISENIMLOBORTISSCELERISQUEFERMENTUMDUIFAUCIBUSSITAMETTELLUSCRASADIPISCINGENIMFAUCIBUSAPELLENTESQUESITAMETPORTTITOREGETDOLORMORBITRISTIQUEETEGESTASQUISIPSUMSUSPENDISSEULTRICESGRAVIDADICTUMALIQUAMVESTIBULUMMORBIBLANDITCURSUSRISUSATULTRICESMITEMPUSCONSEQUATNISLVELPRETIUMLECTUSADIPISCINGBIBENDUMESTULTRICIESINTEGERQUISAUCTORCURABITURGRAVIDAARCUACTORTORDIGNISSIMCONVALLISAENEANETTORTOREUSCELERISQUEFELISIMPERDIETPROI"
    val test6 = "ALIQUAMVESTIBULUMMORBIBLANDITCURSUSRISUSATULTRICESMITEMPUSCONSEQUATNISLVELPRETIUMLECTUSADIPISCINGBIBENDUMESTULTRICIESINTEGERQUISAUCTORCURABITURGRAVIDAARCUACTORTORDIGNISSIMCONVALLISAENEANETTORTOREUSCELERISQUEFELISIMPERDIETPROINELITPELLENTESQUEHABITANTMORBITRISTIQUESENECTUSETNETUSETMALESUADAAUGUEUTLECTUSARCUBIBENDUMLUCTUSVENENATISLECTUSMAGNAFRINGILLAURNAPORTTITORRHONCUSDOLOREGETARCUDICTUMVARIUSDUISEGETDUISATTELLUSATURNACONDIMENTUMMATTISFEUGIATINANTEMETUSDICTUMATEROSINCURSUSTURPISMASSAMOLLISALIQUAMUTPORTTITORLEOADIAMSOLLICITUDINTEMPORIDDIAMPHASELLUSVESTIBULUMLOREMSEDRISUSULTRICIESTRISTIQUENULLAALIQUETSEMPERFEUGIATNIBHSEDPULVINARPROINGRAVIDAHENDRERITLECTUSUTPHARETRASITAMETALIQUAMNULLAPELLENTESQUEDIGNISSIMENIMSITAMETNUNCNONBLANDITMASSAENIMNECDUIALIQUAMSEMFRINGILLAUTMORBITINCIDUNTAUGUEINTERDUMTELLUSATURNACONDIMENTUMMATTISPELLENTESQUEELITATIMPERDIETDUIACCUMSANSITAMETNULLAFACILISIMORBIPELLENTESQUEHABITANTMORBITRISTIQUESENECTUSETNETUSETMALESUADAVIVERRANIBHCRASPULVINARMATTISVENENATISCRASSEDFELISEGETVELITALIQUETSAGITTISIDCONSECTETURNETUSETMALESUADAFAMESACTURPISEGESTASINTEGERORNARELECTUSSITAMETESTPLACERATINEGESTASERAT"
    test(test1, enigmaM3_5)
    test(test2, enigmaM3_5)
    test(test3, enigmaM3_5)
    test(test4, enigmaM3_5)
    test(test5, enigmaM3_5)
    test(test6, enigmaM3_5)

    test(test1, kenigma)
    test(test2, kenigma)
    test(test3, kenigma)
    test(test4, kenigma)
    test(test5, kenigma)
    test(test6, kenigma)

    test(test1, myenigma)
    test(test2, myenigma)
    test(test3, myenigma)
    test(test4, myenigma)
    test(test5, myenigma)
    test(test6, myenigma)
}
